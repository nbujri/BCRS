"use strict";(self.webpackChunkbcrs=self.webpackChunkbcrs||[]).push([[914],{3914:(fe,g,u)=>{u.r(g),u.d(g,{SecurityModule:()=>pe});var m=u(6814),a=u(9351),p=u(9862),o=u(95),e=u(9468);let f=(()=>{class r{static#e=this.\u0275fac=function(s){return new(s||r)};static#r=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-security"]],decls:1,vars:0,template:function(s,t){1&s&&e._UZ(0,"router-outlet")},dependencies:[a.lC],encapsulation:2})}return r})();var h=u(459);let c=(()=>{class r{constructor(i){this.http=i}signin(i,s){return this.http.post("/api/security/signin",{email:i,password:s})}register(i){return this.http.post("/api/security/register",{user:i})}verifyEmail(i){return this.http.post("/api/security/verify/users/"+i,{})}findSelectedSecurityQuestions(i){return this.http.get("/api/users/"+i+"/security-questions")}verifySecurityQuestions(i,s){return this.http.post("/api/security/verify/users/"+i+"/security-questions",{securityQuestions:s})}changePassword(i,s){return this.http.post("/api/security/users/"+i+"/reset-password",{password:s})}static#e=this.\u0275fac=function(s){return new(s||r)(e.LFG(p.eN))};static#r=this.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function v(r,n){if(1&r&&(e.TgZ(0,"div",19),e._uU(1),e.qZA()),2&r){const i=e.oxw();e.xp6(1),e.hij(" ",i.errorMessage," ")}}function _(r,n){1&r&&(e.TgZ(0,"div")(1,"div",20),e._uU(2," Email is required. "),e._UZ(3,"input",21),e.qZA()())}function q(r,n){1&r&&(e.TgZ(0,"div")(1,"div",20),e._uU(2," Please enter a valid email address. "),e._UZ(3,"input",21),e.qZA()())}function y(r,n){1&r&&(e.TgZ(0,"div")(1,"div",20),e._uU(2," Password is required. "),e._UZ(3,"input",21),e.qZA()())}function Z(r,n){1&r&&(e.TgZ(0,"div")(1,"div",20),e._uU(2," Password must be at least 8 characters long and contain one uppercase and lowercase letter, and one number "),e._UZ(3,"input",21),e.qZA()())}let b=(()=>{class r{constructor(i,s,t,l,d){this.fb=i,this.router=s,this.cookieService=t,this.secService=l,this.route=d,this.isLoading=!1,this.signinForm=this.fb.group({email:[null,o.kI.compose([o.kI.required,o.kI.email])],password:[null,o.kI.compose([o.kI.required,o.kI.pattern("^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[a-zA-Z]).{8,}$")])]}),this.errorMessage=""}signin(){this.isLoading=!0,console.log("Sign in Form:",this.signinForm.value);let i=this.signinForm.controls.email.value,s=this.signinForm.controls.password.value;if(!i||!s)return this.errorMessage="Please provide an email address and password",void(this.isLoading=!1);this.secService.signin(i,s).subscribe({next:t=>{console.log("User:",t),this.cookieService.set("session_user",JSON.stringify({fullName:`${t.firstName} ${t.lastName}`,role:t.role,email:t.email}),1);const d=this.route.snapshot.queryParamMap.get("returnUrl")||"/";this.isLoading=!1,this.router.navigate([d])},error:t=>{this.isLoading=!1,console.log("err",t),401!==t.error.status||(this.errorMessage=t.error.message)}})}static#e=this.\u0275fac=function(s){return new(s||r)(e.Y36(o.qu),e.Y36(a.F0),e.Y36(h.N),e.Y36(c),e.Y36(a.gz))};static#r=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-signin"]],decls:31,vars:7,consts:[[1,"container","text-center"],[1,"mt-5"],[1,"row","justify-content-center","mt-5"],[1,"col-lg-6","col-md-5","col-sm-6"],[1,"card","shadow","p-5","text-yellow"],[1,"card-title"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"card-body"],[3,"formGroup","ngSubmit"],[4,"ngIf"],[1,"mb-3"],["for","email",1,"form-label"],["type","text","id","email","formControlName","email",1,"form-control"],["for","password",1,"form-label"],["type","password","id","password","formControlName","password",1,"form-control"],[1,"row","gy-3","mt-5"],["type","submit",1,"btn","btn-dark","text-yellow",3,"disabled"],["type","button","routerLink","/security/forgot-password",1,"btn","btn-dark","text-yellow"],["routerLink","/security/register",1,"btn","btn-dark","text-yellow"],["role","alert",1,"alert","alert-danger"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show"],["type","button","data-bs-dismiss","alert","aria-label","close",1,"btn-close"]],template:function(s,t){1&s&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2,"Bob's Computer Repair Shop"),e.qZA(),e.TgZ(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"h2"),e._uU(8,"User Sign In"),e.qZA()(),e.YNc(9,v,2,1,"div",6),e.TgZ(10,"div",7)(11,"form",8),e.NdJ("ngSubmit",function(){return t.signin(),t.signinForm.reset()}),e.YNc(12,_,4,0,"div",9),e.YNc(13,q,4,0,"div",9),e.TgZ(14,"div",10)(15,"label",11),e._uU(16,"Email:"),e.qZA(),e._UZ(17,"input",12),e.qZA(),e.YNc(18,y,4,0,"div",9),e.YNc(19,Z,4,0,"div",9),e.TgZ(20,"div",10)(21,"label",13),e._uU(22,"Password:"),e.qZA(),e._UZ(23,"input",14),e.qZA(),e.TgZ(24,"div",15)(25,"button",16),e._uU(26," Sign In "),e.qZA(),e.TgZ(27,"button",17),e._uU(28," Forgot Password? "),e.qZA(),e.TgZ(29,"a",18),e._uU(30,"Register"),e.qZA()()()()()()()()),2&s&&(e.xp6(9),e.Q6J("ngIf",t.errorMessage),e.xp6(2),e.Q6J("formGroup",t.signinForm),e.xp6(1),e.Q6J("ngIf",t.signinForm.controls.email.touched&&t.signinForm.controls.email.hasError("required")),e.xp6(1),e.Q6J("ngIf",t.signinForm.controls.email.touched&&t.signinForm.controls.email.hasError("email")),e.xp6(5),e.Q6J("ngIf",t.signinForm.controls.password.touched&&t.signinForm.controls.password.hasError("required")),e.xp6(1),e.Q6J("ngIf",t.signinForm.controls.password.touched&&t.signinForm.controls.password.hasError("pattern")),e.xp6(6),e.Q6J("disabled",!t.signinForm.valid))},dependencies:[m.O5,a.rH,o._Y,o.Fj,o.JJ,o.JL,o.sg,o.u],styles:[".card[_ngcontent-%COMP%]{background-color:#740001}.text-yellow[_ngcontent-%COMP%]{color:#eeba30!important}"]})}return r})();function w(r,n){if(1&r&&(e.TgZ(0,"div",42)(1,"div",43)(2,"div",44),e._uU(3),e.qZA()()()),2&r){const i=e.oxw();e.xp6(3),e.hij(" ",i.errorMessage," ")}}function T(r,n){1&r&&(e.TgZ(0,"div")(1,"div",45),e._uU(2," Email is required. "),e.qZA()())}function A(r,n){1&r&&(e.TgZ(0,"div")(1,"div",45),e._uU(2,"Email is invalid."),e.qZA()())}function F(r,n){1&r&&(e.TgZ(0,"div")(1,"div",45),e._uU(2," Password is required. "),e.qZA()())}function U(r,n){1&r&&(e.TgZ(0,"div")(1,"div",45),e._uU(2," Password must be at least 8 characters long and contain one uppercase and lowercase letter, and one number "),e.qZA()())}function C(r,n){1&r&&(e.TgZ(0,"div")(1,"div",45),e._uU(2," First name is required. "),e.qZA()())}function I(r,n){1&r&&(e.TgZ(0,"div")(1,"div",45),e._uU(2," Last name is required. "),e.qZA()())}function S(r,n){1&r&&(e.TgZ(0,"div")(1,"div",45),e._uU(2," Phone number is required. "),e.qZA()())}function N(r,n){1&r&&(e.TgZ(0,"div")(1,"div",45),e._uU(2," Address is required. "),e.qZA()())}function Q(r,n){1&r&&(e.TgZ(0,"div")(1,"div",45),e._uU(2," Please choose your first question. "),e.qZA()())}function x(r,n){1&r&&(e.TgZ(0,"div")(1,"div",45),e._uU(2," Please answer your first question. "),e.qZA()())}function J(r,n){if(1&r&&(e.TgZ(0,"option",46),e._uU(1),e.qZA()),2&r){const i=n.$implicit;e.Q6J("value",i),e.xp6(1),e.hij(" ",i," ")}}function k(r,n){1&r&&(e.TgZ(0,"div")(1,"div",45),e._uU(2," Please choose your second question. "),e.qZA()())}function Y(r,n){1&r&&(e.TgZ(0,"div")(1,"div",45),e._uU(2," Please answer your second question. "),e.qZA()())}function L(r,n){if(1&r&&(e.TgZ(0,"option",46),e._uU(1),e.qZA()),2&r){const i=n.$implicit;e.Q6J("value",i),e.xp6(1),e.hij(" ",i," ")}}function P(r,n){1&r&&(e.TgZ(0,"div")(1,"div",45),e._uU(2," Please choose your third question. "),e.qZA()())}function E(r,n){1&r&&(e.TgZ(0,"div")(1,"div",45),e._uU(2," Please answer your third question. "),e.qZA()())}function R(r,n){if(1&r&&(e.TgZ(0,"option",47),e._uU(1),e.qZA()),2&r){const i=n.$implicit;e.Q6J("value",i),e.xp6(1),e.hij(" ",i," ")}}let M=(()=>{class r{constructor(i,s,t){this.router=i,this.fb=s,this.securityService=t,this.registerForm=this.fb.group({email:[null,o.kI.compose([o.kI.required,o.kI.email])],password:[null,o.kI.compose([o.kI.required,o.kI.pattern("^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[a-zA-Z]).{8,}$")])],firstName:[null,o.kI.compose([o.kI.required])],lastName:[null,o.kI.compose([o.kI.required])],phoneNumber:[null,o.kI.compose([o.kI.required])],address:[null,o.kI.compose([o.kI.required])],question1:[null,o.kI.compose([o.kI.required])],answer1:[null,o.kI.compose([o.kI.required])],question2:[null,o.kI.compose([o.kI.required])],answer2:[null,o.kI.compose([o.kI.required])],question3:[null,o.kI.compose([o.kI.required])],answer3:[null,o.kI.compose([o.kI.required])]}),this.securityQuestions=["what is your favorite color?","what is your favorite food?","what was the model of your first car?","what highschool did you go to?","what was the name of you pet?","what is the name of your favorite band?"],this.questionsArray1=this.securityQuestions,this.questionsArray2=[],this.questionsArray3=[],this.user={},this.errorMessage=""}ngOnInit(){this.registerForm.get("question1")?.valueChanges.subscribe(i=>{console.log("question 1 value change: ",i),this.questionsArray2=this.questionsArray1.filter(s=>s!==i)}),this.registerForm.get("question2")?.valueChanges.subscribe(i=>{console.log("question 2 value change: ",i),this.questionsArray3=this.questionsArray2.filter(s=>s!==i)})}register(){this.user={email:this.registerForm.get("email")?.value,password:this.registerForm.get("password")?.value,firstName:this.registerForm.get("firstName")?.value,lastName:this.registerForm.get("lastName")?.value,phoneNumber:this.registerForm.get("phoneNumber")?.value,address:this.registerForm.get("address")?.value,role:"standard",isDisabled:!1,selectedSecurityQuestions:[{question:this.registerForm.get("question1")?.value,answer:this.registerForm.get("answer1")?.value},{question:this.registerForm.get("question2")?.value,answer:this.registerForm.get("answer2")?.value},{question:this.registerForm.get("question3")?.value,answer:this.registerForm.get("answer3")?.value}]},console.log("new user: ",this.user),this.securityService.register(this.user).subscribe({next:i=>{console.log("result: ",i),this.router.navigate(["/security/signin"])},error:i=>{i.error.message?(console.log("db error: ",i.error.message),this.errorMessage=i.error.message):(this.errorMessage="something went wrong. please contact the system administrator",console.log(i))}})}static#e=this.\u0275fac=function(s){return new(s||r)(e.Y36(a.F0),e.Y36(o.qu),e.Y36(c))};static#r=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-register"]],decls:89,vars:19,consts:[[1,"container-fluid","black-bg","pt-3","pb-3"],[1,"card","p-5","w-75","m-auto","red-bg","text-yellow"],[1,"text-center"],[1,"card-body","mt-5","w-75","m-auto"],[3,"formGroup","ngSubmit"],["class","row",4,"ngIf"],[1,"m-auto"],[4,"ngIf"],[1,"mb-3"],["for","email",1,"form-label"],["type","email","id","email","formControlName","email",1,"form-control"],["for","password",1,"form-label"],["type","password","id","password","formControlName","password",1,"form-control"],["for","firstName",1,"form-label"],["type","text","id","firstName","formControlName","firstName",1,"form-control"],["for","lastName",1,"form-label"],["type","text","id","lastName","formControlName","lastName",1,"form-control"],["for","phoneNumber",1,"form-label"],["type","text","id","phoneNumber","formControlName","phoneNumber",1,"form-control"],["for","address",1,"form-label"],["type","text","id","address","formControlName","address",1,"form-control"],[1,"mb-3","row"],[1,"col-8"],["for","q1",1,"form-label"],["name","securityQuestion","id","q1","formControlName","question1",1,"form-select"],[3,"value",4,"ngFor","ngForOf"],[1,"col-4"],["for","answer-1",1,"form-label"],["type","text","id","answer-1","formControlName","answer1",1,"form-control"],["for","q2",1,"form-label"],["name","securityQuestion","id","q2","formControlName","question2",1,"form-select"],["for","answer-2",1,"form-label"],["type","text","id","answer-2","formControlName","answer2",1,"form-control"],["for","q3",1,"form-label"],["name","securityQuestion","id","q3","formControlName","question3",1,"form-select"],["selected","",3,"value",4,"ngFor","ngForOf"],["for","answer-3",1,"form-label"],["type","text","id","answer-3","formControlName","answer3",1,"form-control"],[1,"row","gx-3","mt-5","justify-content-around"],[1,"col-5"],[1,"btn","btn-dark","w-100","text-yellow"],["routerLink","/security/signin",1,"btn","btn-dark","w-100","text-yellow"],[1,"row"],[1,"col-12"],[1,"alert","alert-danger"],["role","alert",1,"alert","alert-danger"],[3,"value"],["selected","",3,"value"]],template:function(s,t){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h1",2),e._uU(3,"User Registration"),e.qZA(),e.TgZ(4,"div",3)(5,"form",4),e.NdJ("ngSubmit",function(){return t.register()}),e.YNc(6,w,4,1,"div",5),e.TgZ(7,"fieldset",6)(8,"h3"),e._uU(9,"Account Credentials"),e.qZA(),e.YNc(10,T,3,0,"div",7),e.YNc(11,A,3,0,"div",7),e.TgZ(12,"div",8)(13,"label",9),e._uU(14,"Email:"),e.qZA(),e._UZ(15,"input",10),e.qZA(),e.YNc(16,F,3,0,"div",7),e.YNc(17,U,3,0,"div",7),e.TgZ(18,"div",8)(19,"label",11),e._uU(20,"Password:"),e.qZA(),e._UZ(21,"input",12),e.qZA(),e.TgZ(22,"h3"),e._uU(23,"Personal Information"),e.qZA(),e.YNc(24,C,3,0,"div",7),e.TgZ(25,"div",8)(26,"label",13),e._uU(27,"First Name:"),e.qZA(),e._UZ(28,"input",14),e.qZA(),e.YNc(29,I,3,0,"div",7),e.TgZ(30,"div",8)(31,"label",15),e._uU(32,"Last Name:"),e.qZA(),e._UZ(33,"input",16),e.qZA(),e.YNc(34,S,3,0,"div",7),e.TgZ(35,"div",8)(36,"label",17),e._uU(37,"Phone:"),e.qZA(),e._UZ(38,"input",18),e.qZA(),e.YNc(39,N,3,0,"div",7),e.TgZ(40,"div",8)(41,"label",19),e._uU(42,"Address:"),e.qZA(),e._UZ(43,"input",20),e.qZA(),e.TgZ(44,"h3"),e._uU(45,"Security Questions"),e.qZA(),e.TgZ(46,"div",21),e.YNc(47,Q,3,0,"div",7),e.YNc(48,x,3,0,"div",7),e.TgZ(49,"div",22)(50,"label",23),e._uU(51,"Question 1:"),e.qZA(),e.TgZ(52,"select",24),e.YNc(53,J,2,2,"option",25),e.qZA()(),e.TgZ(54,"div",26)(55,"label",27),e._uU(56,"Answer:"),e.qZA(),e._UZ(57,"input",28),e.qZA()(),e.TgZ(58,"div",21),e.YNc(59,k,3,0,"div",7),e.YNc(60,Y,3,0,"div",7),e.TgZ(61,"div",22)(62,"label",29),e._uU(63,"Question 2:"),e.qZA(),e.TgZ(64,"select",30),e.YNc(65,L,2,2,"option",25),e.qZA()(),e.TgZ(66,"div",26)(67,"label",31),e._uU(68,"Answer:"),e.qZA(),e._UZ(69,"input",32),e.qZA()(),e.TgZ(70,"div",21),e.YNc(71,P,3,0,"div",7),e.YNc(72,E,3,0,"div",7),e.TgZ(73,"div",22)(74,"label",33),e._uU(75,"Question 3:"),e.qZA(),e.TgZ(76,"select",34),e.YNc(77,R,2,2,"option",35),e.qZA()(),e.TgZ(78,"div",26)(79,"label",36),e._uU(80,"Answer:"),e.qZA(),e._UZ(81,"input",37),e.qZA()(),e.TgZ(82,"div",38)(83,"div",39)(84,"button",40),e._uU(85,"Register"),e.qZA()(),e.TgZ(86,"div",39)(87,"button",41),e._uU(88," Cancel "),e.qZA()()()()()()()()),2&s&&(e.xp6(5),e.Q6J("formGroup",t.registerForm),e.xp6(1),e.Q6J("ngIf",t.errorMessage),e.xp6(4),e.Q6J("ngIf",t.registerForm.controls.email.touched&&t.registerForm.controls.email.hasError("required")),e.xp6(1),e.Q6J("ngIf",t.registerForm.controls.email.touched&&t.registerForm.controls.email.hasError("email")),e.xp6(5),e.Q6J("ngIf",t.registerForm.controls.password.touched&&t.registerForm.controls.password.hasError("required")),e.xp6(1),e.Q6J("ngIf",t.registerForm.controls.password.touched&&t.registerForm.controls.password.hasError("pattern")),e.xp6(7),e.Q6J("ngIf",t.registerForm.controls.firstName.touched&&t.registerForm.controls.firstName.hasError("required")),e.xp6(5),e.Q6J("ngIf",t.registerForm.controls.lastName.touched&&t.registerForm.controls.lastName.hasError("required")),e.xp6(5),e.Q6J("ngIf",t.registerForm.controls.phoneNumber.touched&&t.registerForm.controls.phoneNumber.hasError("required")),e.xp6(5),e.Q6J("ngIf",t.registerForm.controls.address.touched&&t.registerForm.controls.address.hasError("required")),e.xp6(8),e.Q6J("ngIf",t.registerForm.controls.question1.touched&&t.registerForm.controls.question1.hasError("required")),e.xp6(1),e.Q6J("ngIf",t.registerForm.controls.answer1.touched&&t.registerForm.controls.answer1.hasError("required")),e.xp6(5),e.Q6J("ngForOf",t.questionsArray1),e.xp6(6),e.Q6J("ngIf",t.registerForm.controls.question2.touched&&t.registerForm.controls.question2.hasError("required")),e.xp6(1),e.Q6J("ngIf",t.registerForm.controls.answer2.touched&&t.registerForm.controls.answer2.hasError("required")),e.xp6(5),e.Q6J("ngForOf",t.questionsArray2),e.xp6(6),e.Q6J("ngIf",t.registerForm.controls.question3.touched&&t.registerForm.controls.question3.hasError("required")),e.xp6(1),e.Q6J("ngIf",t.registerForm.controls.answer3.touched&&t.registerForm.controls.answer3.hasError("required")),e.xp6(5),e.Q6J("ngForOf",t.questionsArray3))},dependencies:[m.sg,m.O5,a.rH,o._Y,o.YN,o.Kr,o.Fj,o.EJ,o.JJ,o.JL,o.sg,o.u],styles:[".container-fluid[_ngcontent-%COMP%]{margin:0!important}.black-bg[_ngcontent-%COMP%]{background-color:#000}.red-bg[_ngcontent-%COMP%]{background-color:#740001;border:1px solid #d3a625}.text-yellow[_ngcontent-%COMP%]{color:#eeba30}"]})}return r})();function V(r,n){if(1&r&&(e.TgZ(0,"div",7)(1,"div",15)(2,"div",16),e._uU(3),e.qZA()()()),2&r){const i=e.oxw();e.xp6(3),e.hij(" ",i.errorMessage," ")}}function O(r,n){1&r&&(e.TgZ(0,"div",17),e._uU(1," Email is required. "),e.qZA())}function j(r,n){1&r&&(e.TgZ(0,"div"),e._uU(1," Email must be a valid email address. "),e.qZA())}function B(r,n){1&r&&(e.TgZ(0,"span"),e._uU(1,"Verify Account"),e.qZA())}function z(r,n){1&r&&(e.TgZ(0,"div"),e._UZ(1,"span",18),e._uU(2," Loading... "),e.qZA())}let G=(()=>{class r{constructor(i,s,t){this.fb=i,this.router=s,this.securityService=t,this.isLoading=!1,this.emailForm=this.fb.group({email:["",o.kI.compose([o.kI.required,o.kI.email])]}),this.errorMessage=""}verifyEmail(){this.isLoading=!0;const i=this.emailForm.controls.email.value;this.securityService.verifyEmail(i).subscribe({next:s=>{this.router.navigate(["security/verify-security-questions"],{queryParams:{email:i},skipLocationChange:!0})},error:s=>{console.log("Server Error from verifyEmail Call:",s),404!==s.status?(this.errorMessage="There was a problem verifying your email address. Please try again later.",this.isLoading=!1):this.errorMessage="The email address you entered was not found. Please try again"},complete:()=>{this.isLoading=!1}})}static#e=this.\u0275fac=function(s){return new(s||r)(e.Y36(o.qu),e.Y36(a.F0),e.Y36(c))};static#r=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-verify-email"]],decls:21,vars:7,consts:[[1,"container","mt-5"],[1,"row","justify-content-center","mt-5"],[1,"col-lg-8","col-md-10"],[1,"card","shadow","p-4","red-bg","text-yellow"],[1,"form","row","g-3",3,"formGroup","ngSubmit"],["class","row",4,"ngIf"],[1,"mb-3","form-group"],[1,"row"],[1,"col-md-12"],["formControlName","email","type","text","id","email","name","email","required","",1,"form-control"],["class","alert alert-danger mt-2",4,"ngIf"],[4,"ngIf"],["type","submit","id","submit",1,"btn","btn-lg","btn-dark","w-100","text-yellow",3,"disabled"],["routerLink","/",1,"text-dark","text-underline-hover"],["mat-raised","","button","",1,"btn"],[1,"col-12"],[1,"alert","alert-danger"],[1,"alert","alert-danger","mt-2"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(s,t){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"form",4),e.NdJ("ngSubmit",function(){return t.verifyEmail()}),e.YNc(5,V,4,1,"div",5),e.TgZ(6,"fieldset",6)(7,"legend"),e._uU(8," Enter the email address associated with your account"),e.qZA(),e.TgZ(9,"div",7)(10,"div",8),e._UZ(11,"input",9),e.YNc(12,O,2,0,"div",10),e.YNc(13,j,2,0,"div",11),e.qZA()()(),e.TgZ(14,"button",12),e.YNc(15,B,2,0,"span",11),e.YNc(16,z,3,0,"div",11),e.qZA()()(),e._UZ(17,"br"),e.TgZ(18,"a",13)(19,"button",14),e._uU(20,"Go Back"),e.qZA()()()()()),2&s&&(e.xp6(4),e.Q6J("formGroup",t.emailForm),e.xp6(1),e.Q6J("ngIf",t.errorMessage),e.xp6(7),e.Q6J("ngIf",t.emailForm.controls.email.invalid&&(t.emailForm.controls.email.dirty||t.emailForm.controls.email.touched)),e.xp6(1),e.Q6J("ngIf",t.emailForm.controls.email.hasError("email")),e.xp6(1),e.Q6J("disabled",!t.emailForm.valid),e.xp6(1),e.Q6J("ngIf",!t.isLoading),e.xp6(1),e.Q6J("ngIf",t.isLoading))},dependencies:[m.O5,a.rH,o._Y,o.Fj,o.JJ,o.JL,o.Q7,o.sg,o.u]})}return r})();function $(r,n){if(1&r&&(e.TgZ(0,"div",8)(1,"div",18)(2,"div",19),e._uU(3),e.qZA()()()),2&r){const i=e.oxw();e.xp6(3),e.hij(" ",i.errorMessage," ")}}function X(r,n){1&r&&(e.TgZ(0,"div",20),e._uU(1," Password is required. "),e.qZA())}function H(r,n){1&r&&(e.TgZ(0,"div",7),e._uU(1," Password must be at least 8 characters long, contain at least one uppercase letter, one lowercase letter, and one number. "),e.qZA())}function D(r,n){1&r&&(e.TgZ(0,"span"),e._uU(1,"Change Password"),e.qZA())}function K(r,n){1&r&&(e.TgZ(0,"div"),e._UZ(1,"span",21),e._uU(2," Loading... "),e.qZA())}let W=(()=>{class r{constructor(i,s,t,l){this.fb=i,this.securityService=s,this.route=t,this.router=l,this.isLoading=!1,this.changePasswordForm=this.fb.group({password:[null,o.kI.compose([o.kI.required,o.kI.pattern("^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[a-zA-Z]).{8,}$")])]}),this.email=this.route.snapshot.queryParamMap.get("email")??"",this.errorMessage="",this.email||(console.log("No email address found"),this.router.navigate(["/security/signin"]))}changePassword(){this.isLoading=!0,this.securityService.changePassword(this.email,this.changePasswordForm.controls.password.value).subscribe({next:s=>{console.log(s),this.router.navigate(["/security/signin"])},error:s=>{console.log(s),this.errorMessage=s,this.isLoading=!1},complete:()=>{this.isLoading=!1}})}static#e=this.\u0275fac=function(s){return new(s||r)(e.Y36(o.qu),e.Y36(c),e.Y36(a.gz),e.Y36(a.F0))};static#r=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-reset-password"]],decls:22,vars:7,consts:[[1,"contianer","mt-5"],[1,"row","justify-content-center","mt-5"],[1,"col-lg-8","col-md-10"],[1,"card-shadow","p-4","red-bg","text-yellow"],[1,"form","row","g-3",3,"formGroup","ngSubmit"],["class","row",4,"ngIf"],[1,"mb-3","form-group"],[1,""],[1,"row"],[1,"col-md-12"],["type","password","formControlName","password",1,"form-control"],["class","alert alert-danger mt-2",4,"ngIf"],["class","",4,"ngIf"],[1,"col-md-6"],["type","submit","id","submit","value","Change Password",1,"btn","btn-dark","w-100","text-yellow",3,"disabled"],[4,"ngIf"],["routerLink","/",1,"text-underline-hover"],["mat-raised","","button","",1,"btn"],[1,"col-12"],[1,"alert","alert-danger"],[1,"alert","alert-danger","mt-2"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(s,t){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"form",4),e.NdJ("ngSubmit",function(){return t.changePassword()}),e.YNc(5,$,4,1,"div",5),e.TgZ(6,"fieldset",6)(7,"legend",7),e._uU(8,"Enter Your New Password"),e.qZA(),e.TgZ(9,"div",8)(10,"div",9),e._UZ(11,"input",10),e.YNc(12,X,2,0,"div",11),e.YNc(13,H,2,0,"div",12),e.qZA()()(),e.TgZ(14,"div",13)(15,"button",14),e.YNc(16,D,2,0,"span",15),e.YNc(17,K,3,0,"div",15),e.qZA()()()(),e._UZ(18,"br"),e.TgZ(19,"a",16)(20,"button",17),e._uU(21,"Go Back"),e.qZA()()()()()),2&s&&(e.xp6(4),e.Q6J("formGroup",t.changePasswordForm),e.xp6(1),e.Q6J("ngIf",t.errorMessage),e.xp6(7),e.Q6J("ngIf",t.changePasswordForm.controls.password.invalid&&(t.changePasswordForm.controls.password.dirty||t.changePasswordForm.controls.password.touched)),e.xp6(1),e.Q6J("ngIf",t.changePasswordForm.controls.password.hasError("pattern")),e.xp6(2),e.Q6J("disabled",!t.changePasswordForm.valid),e.xp6(1),e.Q6J("ngIf",!t.isLoading),e.xp6(1),e.Q6J("ngIf",t.isLoading))},dependencies:[m.O5,a.rH,o._Y,o.Fj,o.JJ,o.JL,o.sg,o.u]})}return r})();function ee(r,n){if(1&r&&(e.TgZ(0,"div")(1,"div",19)(2,"div",20),e._uU(3),e.qZA()()()),2&r){const i=e.oxw();e.xp6(3),e.hij(" ",i.errorMessage," ")}}function re(r,n){1&r&&(e.TgZ(0,"div",21)(1,"span",22),e._uU(2,"Loading..."),e.qZA()())}function te(r,n){if(1&r&&(e.TgZ(0,"label",23),e._uU(1),e.qZA()),2&r){const i=e.oxw();e.xp6(1),e.Oqu(i.question1)}}function ie(r,n){1&r&&(e.TgZ(0,"div",24),e._uU(1," Answer is required. "),e.qZA())}function oe(r,n){1&r&&(e.TgZ(0,"div",21)(1,"span",22),e._uU(2,"Loading..."),e.qZA()())}function se(r,n){if(1&r&&(e.TgZ(0,"label",25),e._uU(1),e.qZA()),2&r){const i=e.oxw();e.xp6(1),e.Oqu(i.question2)}}function ne(r,n){1&r&&(e.TgZ(0,"div",24),e._uU(1," Answer is required. "),e.qZA())}function ae(r,n){1&r&&(e.TgZ(0,"div",21)(1,"span",22),e._uU(2,"Loading..."),e.qZA()())}function le(r,n){if(1&r&&(e.TgZ(0,"label",23),e._uU(1),e.qZA()),2&r){const i=e.oxw();e.xp6(1),e.Oqu(i.question3)}}function ue(r,n){1&r&&(e.TgZ(0,"div",24),e._uU(1," Answer is required. "),e.qZA())}function de(r,n){1&r&&(e.TgZ(0,"span"),e._uU(1,"Verify Security Questions"),e.qZA())}function me(r,n){1&r&&(e.TgZ(0,"div"),e._UZ(1,"span",26),e._uU(2," Loading... "),e.qZA())}const ce=[{path:"",component:f,title:"BCRS: Security",children:[{path:"signin",component:b,title:"BCRS: Sign In"},{path:"register",component:M,title:"BCRS: Register New User"},{path:"forgot-password",component:G,title:"BCRS: Verify Email"},{path:"verify-security-questions",component:(()=>{class r{constructor(i,s,t,l){this.route=i,this.router=s,this.securityService=t,this.fb=l,this.sqForm=this.fb.group({answer1:["",o.kI.compose([o.kI.required])],answer2:["",o.kI.compose([o.kI.required])],answer3:["",o.kI.compose([o.kI.required])]}),this.selectedSecurityQuestions=[],this.question1="",this.question2="",this.question3="",this.errorMessage="",this.isLoadingLabels=!0,this.isLoadingSubmit=!1,this.email=this.route.snapshot.queryParamMap.get("email")??"",this.email?this.securityService.findSelectedSecurityQuestions(this.email).subscribe({next:d=>{this.selectedSecurityQuestions=d,console.log("Users selected security questions",this.selectedSecurityQuestions)},error:d=>{console.log("Server Error from findSelectedSecurityQuestion Call:",d),404!==d.status?(this.errorMessage="There was a problem verifying your security questions. Please try again.",this.isLoadingLabels=!1):this.errorMessage="The email address you entered was not found."},complete:()=>{this.question1=this.selectedSecurityQuestions[0].question,this.question2=this.selectedSecurityQuestions[1].question,this.question3=this.selectedSecurityQuestions[2].question,console.log(this.question1),this.isLoadingLabels=!1}}):this.router.navigate(["/security/forgot-password"])}verifySecurityQuestions(){this.isLoadingSubmit=!0,console.log(this.sqForm.value);let i=[{question:this.question1,answer:this.sqForm.controls.answer1.value},{question:this.question2,answer:this.sqForm.controls.answer2.value},{question:this.question3,answer:this.sqForm.controls.answer3.value}];console.log("User provided security questions",i),this.securityService.verifySecurityQuestions(this.email,i).subscribe({next:s=>{console.log("Response from verifySecurityQuestions Call:",s),this.router.navigate(["/security/reset-password"],{queryParams:{email:this.email},skipLocationChange:!0})},error:s=>{if(s.error.message)return this.errorMessage=s.error.message,void console.error("Server Error from verifySecurityQuestions Call:",s.error.message);console.error("Server Error from verifySecurityQuestions Call:",s),this.errorMessage="There was a problem verifying your security questions. Please try again.",this.isLoadingSubmit=!1},complete:()=>{this.isLoadingSubmit=!1}})}static#e=this.\u0275fac=function(s){return new(s||r)(e.Y36(a.gz),e.Y36(a.F0),e.Y36(c),e.Y36(o.qu))};static#r=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-verify-security-questions"]],decls:36,vars:14,consts:[[1,"container","mt-5"],[1,"row","justify-content-center","mt-5"],[1,"col-lg-8","col-md-10"],[1,"card","shadow","p-4","red-bg","text-yellow"],[1,"form","row","g-3",3,"formGroup","ngSubmit"],[4,"ngIf"],[1,"mb-3","form-group"],[1,"row"],[1,"col-md-12"],["class","spinner-border","role","status",4,"ngIf"],["for","q1","class","form-label",4,"ngIf"],["type","text","formControlName","answer1",1,"form-control"],["class","alert alert-danger mt-2",4,"ngIf"],["for","q2","class","form-label",4,"ngIf"],["type","text","formControlName","answer2",1,"form-control"],["type","text","formControlName","answer3",1,"form-control"],["type","submit","id","submit",1,"btn","btn-lg","btn-dark","w-100","text-yellow",3,"disabled"],["routerLink","/",1,"text-dark","text-underline-hover"],["mat-raised","","button","",1,"btn"],[1,"col-12"],[1,"alert","alert-danger"],["role","status",1,"spinner-border"],[1,"visually-hidden"],["for","q1",1,"form-label"],[1,"alert","alert-danger","mt-2"],["for","q2",1,"form-label"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(s,t){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"form",4),e.NdJ("ngSubmit",function(){return t.verifySecurityQuestions()}),e.YNc(5,ee,4,1,"div",5),e.TgZ(6,"fieldset",6)(7,"legend"),e._uU(8,"Security Questions"),e.qZA(),e.TgZ(9,"div",7)(10,"div",8),e.YNc(11,re,3,0,"div",9),e.YNc(12,te,2,1,"label",10),e._UZ(13,"input",11),e.YNc(14,ie,2,0,"div",12),e.qZA()(),e._UZ(15,"br"),e.TgZ(16,"div",7)(17,"div",8),e.YNc(18,oe,3,0,"div",9),e.YNc(19,se,2,1,"label",13),e._UZ(20,"input",14),e.YNc(21,ne,2,0,"div",12),e.qZA()(),e._UZ(22,"br"),e.TgZ(23,"div",7)(24,"div",8),e.YNc(25,ae,3,0,"div",9),e.YNc(26,le,2,1,"label",10),e._UZ(27,"input",15),e.YNc(28,ue,2,0,"div",12),e.qZA()()(),e.TgZ(29,"button",16),e.YNc(30,de,2,0,"span",5),e.YNc(31,me,3,0,"div",5),e.qZA()()(),e._UZ(32,"br"),e.TgZ(33,"a",17)(34,"button",18),e._uU(35,"Go Back"),e.qZA()()()()()),2&s&&(e.xp6(4),e.Q6J("formGroup",t.sqForm),e.xp6(1),e.Q6J("ngIf",t.errorMessage),e.xp6(6),e.Q6J("ngIf",t.isLoadingLabels),e.xp6(1),e.Q6J("ngIf",!t.isLoadingLabels),e.xp6(2),e.Q6J("ngIf",t.sqForm.controls.answer1.invalid&&(t.sqForm.controls.answer1.dirty||t.sqForm.controls.answer1.touched)),e.xp6(4),e.Q6J("ngIf",t.isLoadingLabels),e.xp6(1),e.Q6J("ngIf",!t.isLoadingLabels),e.xp6(2),e.Q6J("ngIf",t.sqForm.controls.answer2.invalid&&(t.sqForm.controls.answer2.dirty||t.sqForm.controls.answer2.touched)),e.xp6(4),e.Q6J("ngIf",t.isLoadingLabels),e.xp6(1),e.Q6J("ngIf",!t.isLoadingLabels),e.xp6(2),e.Q6J("ngIf",t.sqForm.controls.answer3.invalid&&(t.sqForm.controls.answer3.dirty||t.sqForm.controls.answer3.touched)),e.xp6(1),e.Q6J("disabled",!t.sqForm.valid),e.xp6(1),e.Q6J("ngIf",!t.isLoadingSubmit),e.xp6(1),e.Q6J("ngIf",t.isLoadingSubmit))},dependencies:[m.O5,a.rH,o._Y,o.Fj,o.JJ,o.JL,o.sg,o.u]})}return r})(),title:"BCRS: Verify Security Questions"},{path:"reset-password",component:W,title:"BCRS: Reset Password"}]}];let ge=(()=>{class r{static#e=this.\u0275fac=function(s){return new(s||r)};static#r=this.\u0275mod=e.oAB({type:r});static#t=this.\u0275inj=e.cJS({imports:[a.Bz.forChild(ce),a.Bz]})}return r})(),pe=(()=>{class r{static#e=this.\u0275fac=function(s){return new(s||r)};static#r=this.\u0275mod=e.oAB({type:r});static#t=this.\u0275inj=e.cJS({imports:[m.ez,ge,a.Bz,p.JF,o.u5,o.UX]})}return r})()}}]);